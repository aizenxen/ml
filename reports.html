<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>АРМ мониторинга — Отчёты</title>
  <link rel="stylesheet" href="assets.css">
  <script defer src="app.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => { requireAuth(); buildReportPreview(); });
  </script>
</head>
<body>
  <div class="topbar">
    <div class="brand">АРМ мониторинга</div>
    <nav>
      <a href="index.html">Главная</a>
      <a href="experiments.html">Эксперименты</a>
      <a href="incidents.html">Инциденты</a>
      <a href="audit.html">Аудит</a>
      <a href="reports.html" class="active">Отчёты</a>
    </nav>
    <div class="profile">
      <span class="avatar"></span>
      <span class="small">operator@example.com</span>
      <button id="logout-btn" class="btn secondary" type="button">Выйти</button>
    </div>
  </div>

  <div class="container">
    <div class="card">
      <div class="hstack">
        <select style="width:220px">
          <option>Стандартный отчёт</option>
          <option>Эффективность обучений</option>
          <option>Сводка по инцидентам</option>
          <option>Активность пользователей/аудит</option>
        </select>
        <select style="width:180px"><option>Период</option><option>24 часа</option><option>7 дней</option><option>30 дней</option></select>
        <select style="width:180px"><option>Проект</option><option>Recs</option><option>Churn</option><option>Fraud</option></select>
        <button class="btn" onclick="buildReportPreview()">Сформировать</button>
        <button class="btn secondary" onclick="exportPDF()">Скачать PDF</button>
        <button class="btn secondary" onclick="exportCSV()">Скачать CSV</button>
      </div>
    </div>

    <div class="card">
      <h3 style="margin:0">Конструктор произвольного отчёта</h3>
      <div class="vstack" style="margin-top:10px">
        <div class="form-row">
          <label class="vstack" style="width:220px">
            <div class="label">Сущности</div>
            <select>
              <option>Эксперименты</option>
              <option>Run’ы</option>
              <option>Метрики</option>
              <option>Инциденты</option>
              <option>Аудит</option>
              <option>Артефакты</option>
            </select>
          </label>
          <label class="vstack" style="flex:1">
            <div class="label">Поля (через запятую)</div>
            <input class="input" placeholder="id, project, status, started_at, duration_min">
          </label>
          <label class="vstack" style="width:220px">
            <div class="label">Агрегации</div>
            <select><option>count</option><option>avg</option><option>sum</option><option>min</option><option>max</option></select>
          </label>
          <label class="vstack" style="width:220px">
            <div class="label">Группировка</div>
            <input class="input" placeholder="project, status">
          </label>
        </div>
        <div class="form-row">
          <label class="vstack" style="width:220px">
            <div class="label">Период</div>
            <select><option>24 часа</option><option>7 дней</option><option>30 дней</option></select>
          </label>
          <label class="vstack" style="flex:1">
            <div class="label">Фильтр (условие)</div>
            <input class="input" placeholder="status in ('failed','running')">
          </label>
          <div class="hstack" style="align-self:flex-end">
            <button class="btn" onclick="buildReportPreview()">Сформировать</button>
          </div>
        </div>
      </div>
    </div>

    <div id="report-preview" class="card">
      <h3 style="margin:0">Превью отчёта</h3>
      <div class="chart">Табличная сводка + графики (заглушка)</div>
    </div>

    <footer>Прототип UI. Данные фиктивны. © 2025</footer>
  </div>
</body>
</html>
